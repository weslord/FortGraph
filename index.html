<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <title>Dwarf Force-tress</title>
  <style>
  html {
    box-sizing: border-box;
  }

  *, *:before, *:after {
    box-sizing: inherit;
  }

  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
  </style>
  <script src='lib/d3.js'></script>
</head>
<body>
<script>
{ // INIT
  var width = 960,
      height = 500;

  var svg = d3.select('body').append('svg')
      .attr('width', width)
      .attr('height', height);

  var circles = svg.selectAll("circle");

  var vertices = [
    {id: 0, x: width/2, y: height/2},
    {id: 1, x: width/4, y: height/6},
    {id: 2, x: width/3, y: height/4}
  ];
  var lastVertexId = 2;
  var edges = [{source: 0, target: 1}];

  svg.on('dblclick', svgClick);

  update();
}

function update() {
  circles = svg.selectAll("circle").data(vertices, function(d){return d.id});

  circles.exit().remove();

  var enter = circles.enter().append("circle")
      .attr('r', 5)
      .attr('cx', function (d) {return d.x})
      .attr('cy', function (d) {return d.y});

  circles = circles.merge(enter)
      .on('click', circleClick);
}

function svgClick () {
  var x = d3.mouse(this)[0];
  var y = d3.mouse(this)[1];

  vertices.push({id: ++lastVertexId, x: x, y: y});

  update();
}

function circleClick (d, i) {
  // changing to an ID-based lookup would be more robust
  vertices.splice(i, 1);

  update();
}
</script>
</body>
